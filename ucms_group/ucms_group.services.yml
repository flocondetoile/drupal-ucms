services:

  ucms_group.storage:
    public: false
    class: MakinaCorpus\Ucms\Group\GroupStorage
    arguments: ["@database", "@event_dispatcher"]

  ucms_group.access:
    public: false
    class: MakinaCorpus\Ucms\Group\GroupAccessService
    arguments: ["@database"]

  ucms_group.manager:
    public: true
    class: MakinaCorpus\Ucms\Group\GroupManager
    arguments: ["@database", "@ucms_group.storage", "@ucms_group.access"]

  # Admin datasources
  ucms_group.admin.group_datasource:
    public: true
    class: MakinaCorpus\Ucms\Group\Page\GroupAdminDatasource
    arguments: ["@database", "@ucms_group.manager"]
  ucms_group.admin.group_member_datasource:
    public: true
    class: MakinaCorpus\Ucms\Group\Page\GroupMembersAdminDatasource
    arguments: ["@database", "@ucms_group.manager"]

  # Various listeners and subscribers
  ucms_group.node_event_subscriber:
    public: true
    class: MakinaCorpus\Ucms\Group\EventDispatcher\NodeEventSubscriber
    arguments: ["@ucms_site.manager", "@ucms_group.manager"]
    tags: [{ name: event_subscriber }]
  ucms_group.context_pane_subscriber:
    public: true
    class: MakinaCorpus\Ucms\Group\EventDispatcher\ContextPaneEventSubscriber
    arguments: ["@ucms_dashboard.action_provider_registry"]
    tags: [{ name: event_subscriber }]

  # Action processors and providers
  ucms_group.action.group_delete:
    public: false
    class: MakinaCorpus\Ucms\Group\Action\GroupDeleteProcessor
    arguments: ["@ucms_group.manager", "@current_user"]
    tags: [{name: ucms_dashboard.action}]
  ucms_group.group_action_provider:
    public: false
    class: MakinaCorpus\Ucms\Group\Action\GroupActionProvider
    arguments: ["@ucms_group.manager", "@current_user"]
    tags: [{name: ucms_dashboard.action_provider}]

services:

  ucms_seo.seo_service:
    class: MakinaCorpus\Ucms\Seo\SeoService
    arguments: ["@entity.manager", "@path.alias_manager", "@path.alias_storage", "@ucms_site.manager", "@database"]

  # This overrides the global one
  path.alias_storage:
    class: MakinaCorpus\Ucms\Seo\Path\SeoAliasStorage
    arguments: ['@database', '@module_handler', "@ucms_site.manager"]

  # Various actions providers for node and site
  ucms_seo.node_action_provider:
    public: false
    class: MakinaCorpus\Ucms\Seo\Action\NodeActionProvider
    arguments: ["@ucms_seo.seo_service", "@current_user"]
    tags: [{name: ucms_dashboard.action_provider}]
  ucms_seo.site_action_provider:
    public: false
    class: MakinaCorpus\Ucms\Seo\Action\SiteActionProvider
    arguments: ["@ucms_seo.seo_service", "@current_user"]
    tags: [{name: ucms_dashboard.action_provider}]

  # Action processors
  ucms_seo.action.alias_canonical:
    public: false
    class: MakinaCorpus\Ucms\Seo\Action\AliasCanonicalProcessor
    arguments: ["@ucms_seo.seo_service", "@current_user"]
    tags: [{name: ucms_dashboard.action}]
  ucms_seo.action.alias_delete:
    public: false
    class: MakinaCorpus\Ucms\Seo\Action\AliasDeleteProcessor
    arguments: ["@ucms_seo.seo_service", "@current_user"]
    tags: [{name: ucms_dashboard.action}]

  ucms_seo.admin.node_alias_datasource:
    class: MakinaCorpus\Ucms\Seo\Page\NodeAliasDatasource
    arguments: ["@database"]

  twig.extension.ucms_seo:
    public: false
    class: MakinaCorpus\Ucms\Seo\Twig\SeoExtension
    arguments: ["@ucms_seo.seo_service", "@ucms_site.manager"]
    tags: [{name: twig.extension}]

  ucms_seo.menu_event_listener:
    class: MakinaCorpus\Ucms\Seo\EventDispatcher\MenuEventListener
    arguments: ["@ucms_seo.seo_service", "@entity.manager"]
    tags:
      - {name: event_listener, event: "menu:tree"}

  ucms_seo.store_locator_factory:
    class: MakinaCorpus\Ucms\Seo\StoreLocator\StoreLocatorFactory

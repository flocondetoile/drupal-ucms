<?php


/**
 * Implements hook_menu().
 */
function ucms_tree_menu() {
  $items['admin/dashboard/tree'] = [
    'title'           => 'Tree',
    'page callback'   => 'sf_dic_page_form',
    'page arguments'  => ['MakinaCorpus\Ucms\Tree\Form\TreeForm'],
    'access callback' => ['ucms_tree_check_access'],
    'type'            => MENU_NORMAL_ITEM,
  ];

  return $items;
}

/**
 * @return mixed
 */
function ucms_tree_check_access($account = NULL) {
  if (!$account) {
    $account = \Drupal::currentUser();
  }

  $manager = ucms_site_manager();
  if ($manager && $manager->getContext()) {
    return $manager
      ->getAccess()
      ->userCanEditTree($account, $manager->getContext())
      ;
  }
  return FALSE;
}
